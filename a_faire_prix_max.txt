================================================================================
          GUIDE - CALCUL PRIX MAX POSSIBLE PAR VOL ET PAR AVION
================================================================================

DATE DE CRÉATION : 15 janvier 2026
OBJECTIF : Calculer et afficher, pour chaque vol opéré, le chiffre d'affaires
           POTENTIEL MAXIMAL qu'un avion peut générer (toutes places vendues)

================================================================================
1. TABLES CONCERNÉES
================================================================================

TABLES PRINCIPALES :
  - vol_opere (id, ligne_vol_id, avion_id, date_heure_depart, date_heure_arrivee, ...)
  - avion (id, code_avion, model_avion_id, etat_avion_id, capacite_totale, ...)

TABLES LIÉES POUR LE CALCUL :
  - siege (id, avion_id, classe_siege_id, numero_siege, ...)
      → Donne le NOMBRE DE SIÈGES par classe pour un avion donné

  - prix_vol (id, vol_opere_id, classe_siege_id, prix_base, ...)
      → Donne le PRIX PAR CLASSE pour un vol opéré donné

ID UTILISÉS DANS LE CALCUL :
  - avion.id          → pour compter les sièges (table siege)
  - vol_opere.id      → pour récupérer les prix par classe (table prix_vol)

================================================================================
2. LOGIQUE DE CALCUL
================================================================================

IDÉE :
  Pour un vol opéré donné (vol_opere_id) et un avion donné (avion_id),
  on multiplie, pour chaque classe de siège :
     NOMBRE DE SIÈGES (table siege) × PRIX PAR SIÈGE (table prix_vol)
  puis on somme sur toutes les classes.

FORMULE SQL (résumé) :
  prix_total_max = SUM( prix_vol.prix_base * nb_sieges_par_classe )

IMPLEMENTATION DANS AvionDAO :
  - Méthode :
      AvionDAO.getPrixTotalMax(int avionId, int volOpereId) : double

  - Rôle :
      Exécuter la requête SQL qui joint prix_vol et siege pour calculer
      le chiffre d'affaires potentiel maximum pour un couple (avion, vol_opere).

================================================================================
3. INTÉGRATION DANS LA PAGE CHIFFRE D'AFFAIRE
================================================================================

FLUX GLOBAL :
  lien/menu → ChiffreAffaireServlet.doGet() → calculs DAO
  → setAttribute(...) → forward vers jsp/chiffre_affaire.jsp

FONCTIONS PRINCIPALES :
  - ChiffreAffaireServlet.doGet(request, response) : void
      * Récupère les filtres (ligne_vol_id, avion_id, dates)
      * Appelle ChiffreAffaireDAO pour :
          - calculer le chiffre d'affaires global
          - calculer le CA par classe
          - récupérer la liste des vols opérés filtrés
      * Pour CHAQUE VolOpere de la liste :
          - Appeller AvionDAO.getPrixTotalMax(vol.getAvionId(), vol.getId())
          - Stocker le résultat dans une Map<Integer, Double> prixMaxParVol
            (clé = vol_opere.id, valeur = prix max possible)
      * Placer les données dans la requête :
          - "volsOperes"     : liste des VolOpere
          - "prixMaxParVol"  : Map<Integer, Double>
          - autres données de chiffre d'affaires
      * Forward vers /jsp/chiffre_affaire.jsp

  - AvionDAO.getPrixTotalMax(avionId : int, volOpereId : int) : double
      * Paramètres :
          - avionId     : identifiant de l'avion (pour table siege)
          - volOpereId  : identifiant du vol opéré (pour table prix_vol)
      * Retour :
          - prix total max possible (double)

================================================================================
4. AFFICHAGE DANS LA JSP chiffre_affaire.jsp
================================================================================

PAGE :
  - WebContent/jsp/chiffre_affaire.jsp

DÉPENDANCES JSP :
  - Attributs de requête attendus :
      * volsOperes    : List<VolOpere>
      * prixMaxParVol : Map<Integer, Double>

LOGIQUE D'AFFICHAGE :
  - Pour chaque vol opéré (vo) dans volsOperes :
      * Récupérer le prix max possible via :
          prix = prixMaxParVol.get(vo.getId())
      * Afficher ce montant dans une colonne dédiée (ex: "Prix Max Possible")

  - Format possible :
      * Utiliser String.format("%.2f €", prix) pour un affichage propre.

================================================================================
5. FICHIERS À CRÉER / MODIFIER
================================================================================

BACKEND (Java) :
  - src/dao/AvionDAO.java
      * Ajouter la méthode getPrixTotalMax(int avionId, int volOpereId) : double

  - src/controller/ChiffreAffaireServlet.java
      * Dans doGet() :
          - Après récupération de la liste des vols opérés,
            boucler sur chaque VolOpere pour construire la Map prixMaxParVol.
          - Passer la Map à la JSP via request.setAttribute("prixMaxParVol", ...).

FRONTEND (JSP) :
  - WebContent/jsp/chiffre_affaire.jsp
      * Ajouter une colonne "Prix max possible" dans le tableau
        des vols opérés.
      * Pour chaque ligne :
          - lire la valeur dans prixMaxParVol à partir de l'id du vol.

================================================================================
6. DÉPENDANCES NÉCESSAIRES
================================================================================

DAO REQUIS :
  - AvionDAO (calcul du prix max)
  - ChiffreAffaireDAO (chiffre d'affaires réel, listes filtrées)

MODEL REQUIS :
  - VolOpere (id, avionId, ...)
  - Avion (id)

AUTRES :
  - Connexion base de données configurée (DatabaseConnection)
  - Tables siege et prix_vol correctement alimentées pour que
    le calcul retourne des valeurs cohérentes.

================================================================================
FIN DU GUIDE - PRIX MAX POSSIBLE
================================================================================
